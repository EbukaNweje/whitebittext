(this.webpackJsonp=this.webpackJsonp||[]).push([[154],{"1+O0":function(e,t,s){"use strict";s.r(t),s.d(t,"useUserStore",(function(){return g})),s("pAeB"),s("DhXE");var i=s("oWzO"),a=s("3nOT"),n=s("pG6T"),r=s("Z/k0"),o=s("6bq2"),c=s("5br9"),l=s("sUB2"),u=s("T5wk"),d=s("elZs"),h=s("RZTQ"),p=s("SUyD");const g=Object(n.c)("user",{state:()=>{var e,t;const{$cookies:s}=Object(i.d)()?Object(i.y)():null!==(e=null===(t=window)||void 0===t?void 0:t.$nuxt)&&void 0!==e?e:{};return{category:"B2C",userId:"",marketName:"",kycFlow:"regular",countryCode:"",nickname:{value:"",tag:""},email:null,p2pExpressEnabled:!1,nicknameChangesLeft:0,lastPasswordEdit:null,country:null,timeUntilBlock:null,restrictedAssets:{deposit:[],withdraw:[],codes:{withdraw:[]}},restrictedProviders:{deposit:[],withdraw:[]},logoutTime:"",isLogined:!(null==s||!s.get("wbIsLoggedIn")),web3AuthAddress:void 0,isTaxLoginConfirmable:!0,benefits:{holdingLevel:void 0,owningLevel:void 0,holding:{freeAmlChecks:void 0,freeWithdrawals:void 0,makerFeeDiscount:void 0,referralRate:40},owning:{takerFeeDiscount:void 0,makerFeeDiscount:void 0}},phone:{id:"",is2fa:!1,number:"",provider:"default",type:""},fioAddress:"",privileges:{canGenerateReferralCodes:!1,isMerchant:!1,isListing:!1,canUseUssd:!1,canCreateManyAddresses:!1,collateralEnabled:!0,earnEnabled:!0,blackCatEnabled:!1},permissions:{collateral:{enabled:!0,hide:!1},earn:{enabled:!0,hide:!1},launchpad:{enabled:!0,hide:!1},wbcard:{enabled:!0,hide:!1}},captcha:{provider:"geetest",enabled:null},flags:{isTwoFactorEnabled:!1,isAntiPhishingCodeEnabled:!1,exchangeTermsAccepted:!1,isQrLoginEnabled:!1}}},actions:{async initUserInfo(){const e=Object(l.useVerificationStore)();try{const{data:c}=await o.a.getInitialInfo();if(this.permissions=Object(h.M)(this.permissions,c.permissions),null!=c&&c.user&&Object(a.isObject)(c.user)){if(Object.keys(this.$nuxt.route.query).includes("brand_id")){const[e]=await Object(h.db)(r.default.zendeskSSOLogin());return void(null!=e&&e.data.redirectUrl&&(window.location.href=e.data.redirectUrl))}if(!this.$nuxt.$cookies.get("wbIsLoggedIn"))return this.$nuxt.$cookies.set("wbIsLoggedIn","true",{secure:!0,sameSite:"lax",path:"/",maxAge:31536e3}),void window.location.reload();this.$patch((t=>{var s,i,a,n,r,o,l,u,d,h,p,g;t.isLogined=!0,t.userId=c.user.externalId,t.logoutTime=c.user.logoutTime,t.nicknameChangesLeft=c.user.nicknameChangesLeft,t.lastPasswordEdit=c.user.lastPasswordEdit,t.nickname={value:c.user.name,tag:c.user.tag},t.fioAddress=null!==(s=c.user.fioAddress)&&void 0!==s?s:"",t.category=null!==(i=c.user.category)&&void 0!==i?i:"B2C",t.logoutTime=c.user.logoutTime,t.privileges=null!==(a=c.user.privileges)&&void 0!==a?a:t.privileges,t.country=c.user.country,t.timeUntilBlock=c.user.timeUntilBlock||null,t.restrictedAssets=c.user.restrictedAssets,t.restrictedProviders=c.user.restrictedProviders,t.web3AuthAddress=c.user.web3AuthAddress,t.p2pExpressEnabled=c.user.p2pExpressEnabled,t.isTaxLoginConfirmable=(null===(n=c.user.integrations)||void 0===n||null===(n=n.koinly)||void 0===n?void 0:n.isLoginConfirmable)||!0,null!==(r=c.user)&&void 0!==r&&r.benefits&&(t.benefits=c.user.benefits),t.phone={...t.phone,number:null!==(o=null===(l=c.user)||void 0===l||null===(l=l.phone)||void 0===l?void 0:l.phone)&&void 0!==o?o:"",provider:(null===(u=c.user)||void 0===u||null===(u=u.phone)||void 0===u?void 0:u.provider)||"default"},t.flags={exchangeTermsAccepted:null!==(d=c.user.exchangeTermsAccepted)&&void 0!==d&&d,isAntiPhishingCodeEnabled:null!==(h=c.user.isAntiPhishingCodeEnabled)&&void 0!==h&&h,isTwoFactorEnabled:null!==(p=c.user.isTwoFactorEnabled)&&void 0!==p&&p,isQrLoginEnabled:null!==(g=c.user.isQrLoginEnabled)&&void 0!==g&&g},t.kycFlow=c.user.kycFlow,e.$patch((e=>{var t;e.kycStatus=null===(t=c.user)||void 0===t?void 0:t.kycStatus}))}));try{var t,s,i,n,p,g,v,f,b,m;null===(t=this.$nuxt)||void 0===t||null===(t=t.$zaraz)||void 0===t||null===(s=t.push)||void 0===s||s.call(t,{user_id:c.user.externalId,external_id:c.user.externalId,uid:c.user.externalId}),null===(i=this.$nuxt)||void 0===i||null===(i=i.$zaraz)||void 0===i||null===(n=i.set)||void 0===n||n.call(i,"user_id",c.user.externalId),null===(p=this.$nuxt)||void 0===p||null===(p=p.$zaraz)||void 0===p||null===(g=p.set)||void 0===g||g.call(p,"external_id",c.user.externalId),null===(v=this.$nuxt)||void 0===v||null===(v=v.$zaraz)||void 0===v||null===(f=v.set)||void 0===f||f.call(v,"uid",c.user.externalId),null===(b=this.$nuxt)||void 0===b||null===(b=b.$zaraz)||void 0===b||null===(m=b.push)||void 0===m||m.call(b,{event:"session_start"})}catch(e){console.error(e)}Object(d.J)((e=>{var t;"classic"===(null===(t=window.zE)||void 0===t?void 0:t.prototype.constructor.widget)&&e("webWidget","identify",{name:c.user.nickname})}))}const l=localStorage.getItem("wb-countryCode");this.$patch((e=>{e.captcha=c.captcha,e.marketName=c.marketName,e.countryCode=l&&2===l.length?l:c.countryCode})),this.$nuxt.$sentry&&(this.$nuxt.$sentry.setContext("permissions",c.permissions),this.$nuxt.$sentry.setTag("countryCode",c.countryCode),null!=c&&c.user&&Object(a.isObject)(c.user)?(this.$nuxt.$sentry.setTag("loggedInState",!0),this.$nuxt.$sentry.setTag("userCountry",c.user.country)):this.$nuxt.$sentry.setTag("loggedInState",!1))}catch(e){e instanceof c.a&&this.$nuxt.$notifier.error({title:"notify.failedToFetch",text:Object.values(e.data).join(". "),code:u.e.FailedToGetInitialInfo})}},async benefitLevelUpdateWS(){const e=await Object(p.a)();await e.connect(),e.listen("benefitLevelUpdate","userStore",(e=>{this.$patch((t=>{t.benefits=e}))}))},async login(e){const{useOrdersStore:t}=await s.e(139).then(s.bind(null,"hQ0b")),i=t();this.$nuxt.$cookies.set("wbIsLoggedIn","true",{secure:!0,sameSite:"lax",path:"/",maxAge:31536e3}),await Promise.all([this.initUserInfo(),i.subscribe()]),this.$nuxt.$zaraz.push({event:"login",userId:e}),this.isLogined=!0},async logout(){var e,t,s,i,a,n;await r.default.logout(),this.$nuxt.$cookies.remove("wbIsLoggedIn"),null===(e=this.$nuxt)||void 0===e||null===(e=e.$zaraz)||void 0===e||null===(t=e.set)||void 0===t||t.call(e,"user_id"),null===(s=this.$nuxt)||void 0===s||null===(s=s.$zaraz)||void 0===s||null===(i=s.set)||void 0===i||i.call(s,"external_id"),null===(a=this.$nuxt)||void 0===a||null===(a=a.$zaraz)||void 0===a||null===(n=a.set)||void 0===n||n.call(a,"uid"),this.$reset(),window.location.reload()}},getters:{countryCodeCurrency(e){if(!e.countryCode)return"";switch(!0){case"UA"===e.countryCode||"UA"===e.country:return"UAH";case"GE"===e.countryCode||"GE"===e.country:return"GEL";case"TR"===e.countryCode||"TR"===e.country:return"TRY";case"KZ"===e.countryCode||"KZ"===e.country:return"KZT";case"AU"===e.countryCode||"AU"===e.country:return"AUD";case"GB"===e.countryCode||"GB"===e.country:return"GBP";case"PL"===e.countryCode||"PL"===e.country:return"PLN";case"BG"===e.countryCode||"BG"===e.country:return"BGN";case"CZ"===e.countryCode||"CZ"===e.country:return"CZK";case u.d.includes(e.countryCode)||u.d.includes(e.country):return"EUR";default:return"USD"}},isOldKYC:e=>"legacy"===e.kycFlow,username:e=>e.nickname?`${e.nickname.value}#${e.nickname.tag}`:""},persist:{paths:["flags.isTwoFactorEnabled"]}})},BRTK:function(e,t,s){"use strict";s.d(t,"a",(function(){return f})),s("vYkN"),s("RBEp"),s("gFaO"),s("y4nJ"),s("S7rW"),s("Hk+b"),s("PU4/"),s("nHM4"),s("e2+r"),s("TmFS"),s("6ViI"),s("0UJC"),s("wNA2"),s("rtEv"),s("OuDy"),s("VGUK"),s("LO4A"),s("wysq"),s("B2uk"),s("j3+x"),s("Um6w"),s("RVFJ"),s("/5+t"),s("ihJP"),s("zy22"),s("/hws"),s("X5mm"),s("0ALk"),s("8U0c"),s("pAeB");var i=s("oWzO"),a=s("M9j4"),n=s("pG6T"),r=s("7grT"),o=s("j4UD"),c=s("s9w7"),l=s("T5wk"),u=s("elZs"),d=s("RZTQ"),h=s("bxIU");let p;const g=new Set,v=new Map,f=Object(n.c)("trade/markets",{state:()=>({data:{},markets:new Set,loadCounter:0,subscribedAll:!1}),actions:{initState(e){Object(i.s)(this,"data",e),Object.freeze(this.data)},resetLoadCounter(){var e;clearTimeout(p),Object(i.s)(this,"loadCounter",0),Object(i.s)(this,"subscribedAll",!1),null==v||v.clear(),null===(e=this.markets)||void 0===e||e.clear()},subscribedAllMarkets(){this.subscribedAll=!0},setMarket({id:e,data:t}){if(this.data[e]){var s;const c=e.split("_")[1];let l;if(!c.includes("USD")){var a,n,r,o;const e=(null===(a=this.data[c+"_USDT"])||void 0===a?void 0:a.price)||(null===(n=this.data[c+"_USD"])||void 0===n?void 0:n.price)||"1",s=(null===(r=this.data["USDT_"+c])||void 0===r?void 0:r.price)||(null===(o=this.data["USD_"+c])||void 0===o?void 0:o.price);l=s?+t.volume/+s:+t.volume*+e}const u=Object.freeze({...this.data[e],...t,volume:Object(d.cb)(t.volume,2),volumeInUSDT:Object(d.cb)(null!==(s=l)&&void 0!==s?s:t.volume,0)});Object(i.s)(this.data,e,u)}},setMarkets(e){const t={};for(const i of Object.keys(e)){var s;const c=i.split("_")[1];let l;if(!c.includes("USD")){var a,n,r,o;const t=(null===(a=e[c+"_USDT"])||void 0===a?void 0:a.price)||(null===(n=e[c+"_USD"])||void 0===n?void 0:n.price)||"1",s=(null===(r=e["USDT_"+c])||void 0===r?void 0:r.price)||(null===(o=e["USD_"+c])||void 0===o?void 0:o.price);l=s?+e[i].volume/+s:+e[i].volume*+t}t[i]=Object.freeze({...this.data[i],...e[i],volume:Object(d.cb)(e[i].volume,2),volumeInUSDT:Object(d.cb)(null!==(s=l)&&void 0!==s?s:e[i].volume,0)})}Object(i.s)(this,"data",t),Object.freeze(this.data),this.loadCounter++},async init(e){if(!this.subscribedAll){const t=Object(o.a)();if(e){for(const t of e)null==g||g.add(t);g&&g.size>0&&await Object(h.p)(g&&g.size>0?Array.from(g):t.config.MARKET_LIST_TICKERS,this.update)}else null==g||g.clear(),await Object(h.p)(t.config.MARKET_LIST_TICKERS,this.update),p=window.setTimeout((()=>{!this.subscribedAll&&v&&(this.setMarkets(Object.fromEntries(v)),this.subscribedAllMarkets(),v.clear())}),5e3)}},async initCurrentMarket(){if(!this.subscribedAll){const e=Object(c.a)(),t=e.currentPair.split("_")[1],s=[e.currentPair,...e.currentPair.includes("USD")?[]:[t+"_USD",t+"_USDT"].filter((e=>window.$nuxt.$pinia.state.value.store.config.MARKET_LIST_TICKERS.includes(e)))];for(const e of s)null==g||g.add(e);g&&g.size>0&&await Object(h.p)(Array.from(g),this.update)}},async fetch(){if(this.loadCounter>0)return;const{success:e,result:t}=await r.a.getMarketsState();if(!e)return void window.$nuxt.$options.$notifier.error({title:"notify.failedToFetch",code:l.e.FailedToGetMarketState});const s=Object(o.a)(),i=Object.keys(t).reduce(((e,i)=>{var a,n;const r=t[i].ticker,o=+r.change;return null!==(a=s.config.MARKET_LIST_TICKERS)&&void 0!==a&&a.includes(i)?(e[i]={price:Object(d.cb)(r.last,null===(n=s.config.PRECISIONS)||void 0===n||null===(n=n[i])||void 0===n?void 0:n.money),volume:Object(d.cb)(r.deal,3),change:o,high:r.high,low:r.low,changeFormatted:r.change+"%",state:o>0?1:o<0?-1:0,volumeInUSDT:"0"},e):e}),{});this.setMarkets(i)},update(e){const t=Object(o.a)(),s=e[0],i=function(e){const t=Object(o.a)(),[s,{open:i,close:n,last:r,deal:c,high:l,low:h}]=e,p=0==+i&&0!=+n?100:0==+i&&0==+n?0:100*(+n/+i-1);return{price:Object(d.cb)(r,t.config.PRECISIONS[s].money),volume:c,change:p,absoluteChange:new a.Decimal(n).minus(i).toString(),high:l,pair:Object(u.h)(s),low:h,changeFormatted:Object(d.cb)(p,2)+"%",state:p>0?1:p<0?-1:0,volumeInUSDT:"0"}}(e);if(null!=g&&g.has(s))this.setMarket({id:s,data:i});else{var n;const e=null===(n=this.markets)||void 0===n?void 0:n.has(s);var r;e||null===(r=this.markets)||void 0===r||r.add(s),e?this.setMarket({id:s,data:i}):v&&(v.set(s,i),v.size===t.config.MARKET_LIST_TICKERS.length&&(this.setMarkets(Object.fromEntries(v)),this.subscribedAllMarkets(),v.clear()))}}},getters:{selectedMarketPriceInUSDT(e){const t=Object(c.a)(),{$formatNumber:s}=Object(i.y)(),n=e.data[t.currentPair],r=t.getCurrentPair.money,o=e.data[r+"_USDT"]||e.data[r+"_USD"];if(!(n&&"USDT"!==r&&"USD"!==r&&o&&n.price&&o.price))return"";const l=new a.Decimal(n.price).mul(o.price).toDecimalPlaces(2);return(l.lessThan("0.01")?"< 0.01":"â‰ˆ "+s(l))+" USDT"}}})},M98h:function(e,t){e.exports={functional:!0,render(e,t){const{_c:s,_v:i,data:a,children:n=[]}=t,{class:r,staticClass:o,style:c,staticStyle:l,attrs:u={},...d}=a;return s("svg",{class:[r,o],style:[c,l],attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},u),...d},n.concat([s("path",{attrs:{fill:"currentColor",d:"M834.8 286.1l176.6-176.6H794.6c-84.3 0-144.8 43.4-167.4 114.9-5.3 16.8-6.7 39-5.3 61.7H405l176.6-176.6H367.3c-97.5 0-176.6 79.1-176.6 176.6h-1.3c-97.5 0-176.6 79.1-176.6 176.6h177.9v133.1c0 176.4 143.2 319.3 319.6 318.9h324.5V286.1M598.9 588.5a88.78 88.78 0 010-125.6l125.6 125.6a88.96 88.96 0 01-125.6 0z"}})]))}}},fbRD:function(e,t,s){"use strict";s.r(t),s.d(t,"actions",(function(){return n}));var i=s("gezm"),a=s("j4UD");const n={async nuxtServerInit(e,{$pinia:t,ssrContext:s}){const n=Object(a.a)(t),r=s.$dataCache.get("serverSettings");if(r)n.$patch((e=>{e.config.WEB3_AUTH_ENABLED=r.WEB3_AUTH_ENABLED,e.config.IS_BUY_CRYPTO_ENABLED=r.IS_BUY_CRYPTO_ENABLED,e.config.QR_LOGIN_ENABLED=r.QR_LOGIN_ENABLED}));else try{const{data:{config:e}}=await i.a.getConfig();s.$dataCache.set("serverSettings",{WEB3_AUTH_ENABLED:e.WEB3_AUTH_ENABLED,IS_BUY_CRYPTO_ENABLED:e.IS_BUY_CRYPTO_ENABLED,QR_LOGIN_ENABLED:e.QR_LOGIN_ENABLED},{ttl:3e5}),n.$patch((t=>{t.config.WEB3_AUTH_ENABLED=e.WEB3_AUTH_ENABLED,t.config.IS_BUY_CRYPTO_ENABLED=e.IS_BUY_CRYPTO_ENABLED,t.config.QR_LOGIN_ENABLED=e.QR_LOGIN_ENABLED}))}catch(e){var o;null===(o=s.$logger)||void 0===o||o.error(e)}}}},j4UD:function(e,t,s){"use strict";s.d(t,"a",(function(){return g})),s("pAeB");var i=s("oWzO"),a=s("pG6T"),n=s("gezm"),r=s("BRTK"),o=s("s9w7"),c=s("1+O0"),l=s("T5wk"),u=s("elZs"),d=s("RZTQ");const h={ADVANCED_CURRENCIES_MAP:{},CURRENCIES_WITH_ZERO_PRECISION:[],FIO_DOMAIN:"",BENEFIT_NETWORKS:[],MARKET_LIST_TICKERS:[],PRECISIONS:{},UNSTOPPABLE_DOMAINS_ALLOWED_DOMAINS:[],IS_BUY_CRYPTO_ENABLED:!1,WEB3_AUTH_ENABLED:!1,QR_LOGIN_ENABLED:!1};async function p(){var e,t;const{useReCaptcha:i}=await s.e(551).then(s.bind(null,"iH31"));window.recaptcha=i(),null===(e=(t=window.recaptcha).initializeReCaptcha)||void 0===e||e.call(t)}const g=Object(a.c)("store",{state:()=>({config:h,campaigns:{}}),actions:{async nuxtClientInit({$notifier:e}){const t=Object(c.useUserStore)(),a=Object.keys(this.$nuxt.route.query).includes("webview");await Promise.all([t.initUserInfo().catch((()=>{e.error({title:"Couldn't fetch user info. Try reloading page",duration:Number.MAX_SAFE_INTEGER/10})})),this.getConfig()]),Object(i.h)((()=>{requestAnimationFrame((()=>{window.$nuxt.$loading.finish()}))})),a||t.captcha.enabled&&("reCaptcha"===t.captcha.provider?"requestIdleCallback"in window?requestIdleCallback(p,{timeout:5e3}):p():"geetest"===t.captcha.provider&&("requestIdleCallback"in window?requestIdleCallback((()=>{s.e(91).then(s.t.bind(null,"Klqz",7))}),{timeout:5e3}):s.e(91).then(s.t.bind(null,"Klqz",7))))},async getConfig(){try{const{data:a}=await n.a.getConfig();if(void 0!==a.config.WEB3_AUTH_ENABLED&&delete a.config.WEB3_AUTH_ENABLED,void 0!==a.config.IS_BUY_CRYPTO_ENABLED&&delete a.config.IS_BUY_CRYPTO_ENABLED,void 0!==a.config.QR_LOGIN_ENABLED&&delete a.config.QR_LOGIN_ENABLED,a){const n={},c={},l={},h=[];for(let i=0,r=null!==(e=null===(t=a.config.MARKET_LIST)||void 0===t?void 0:t.length)&&void 0!==e?e:0;i<r;i++){var e,t,s;const r=a.config.MARKET_LIST[i];n[r.name]={money:r.money_prec,stock:r.stock_prec},h.push(r.name),l[r.name]={pair:Object(u.h)(r.name),price:"0",volume:"0",high:"0",low:"0",change:0,changeFormatted:"0%",state:0,volumeInUSDT:"0",absoluteChange:"0"},c[r.name]={id:r.name,pair:Object(u.h)(r.name),stock:r.stock,money:r.money,defaultTimeInterval:r.defaultTimeInterval,minStock:r.min_amount||"0",moneyPrec:r.money_prec>=0?r.money_prec:8,stockPrec:r.stock_prec>=0?r.stock_prec:8,minStepAmount:null!==(s=r.minStepAmount)&&void 0!==s?s:"0.000000001",enabledMargin:r.enabled_for_margin,moneyMinAmount:r.moneyMinAmount||"0",isFuturesMarket:(null==r?void 0:r.isFuturesMarket)||!1,maxLeverage:(null==r?void 0:r.maxLeverage)||0,deleted:!1}}delete a.config.TICKERS,delete a.config.DEFAULT_PAIR,delete a.config.REFERRAL,delete a.config.MARKET_LIST,Object(i.s)(this,"config",Object(d.M)(this.config,a.config)),Object(i.s)(this.config,"PRECISIONS",n),Object(i.s)(this.config,"MARKET_LIST_TICKERS",h),a.campaigns&&Object(i.s)(this,"campaigns",a.campaigns);const p=Object(o.a)(),g=Object(r.a)();p.setPairs(c),a.config.ADVANCED_CURRENCIES_MAP&&p.setCurrenciesMap(a.config.ADVANCED_CURRENCIES_MAP),g.initState(l)}}catch{this.$nuxt.$notifier.error("notify.failedToFetch",{code:l.e.FailedToGetConfig})}}}})},s9w7:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s("pAeB");var i=s("oWzO"),a=s("pG6T"),n=s("j4UD");const r={stockTicker:"",minAmountStock:"0",moneyTicker:"",market:{},deleted:!1},o=Object(a.c)("trade/pairs",{state:()=>({pairs:{},currentPair:"",currenciesMap:{}}),actions:{setCurrentPair(e){this.currentPair=e},setPairs(e){Object(i.s)(this,"pairs",e)},setCurrenciesMap(e){this.currenciesMap=e},async changePair(e){var t;if(null===(t=Object(n.a)().config.MARKET_LIST_TICKERS)||void 0===t||!t.includes(e))return;this.setCurrentPair(e);const[{useDepthStore:i},{useTradeHistoryStore:a}]=await Promise.all([s.e(554).then(s.bind(null,"Zohk")),s.e(540).then(s.bind(null,"ZYde"))]),r=i(),o=a();await Promise.all([r.subscribe(),o.init()])}},getters:{getCurrentPair(e){var t;return null!==(t=e.pairs[e.currentPair])&&void 0!==t?t:r}},persist:{paths:["currentPair"]}})},sUB2:function(e,t,s){"use strict";s.r(t),s.d(t,"useVerificationStore",(function(){return l})),s("pAeB");var i=s("pG6T"),a=s("LdU6"),n=s("5br9"),r=s("1+O0"),o=s("T5wk"),c=s("SUyD");const l=Object(i.c)("verification",{state:()=>({regular:{steps:{information:{name:"kyc.regular.information.title",status:"active",path:"/verification",data:void 0},address:{name:"kyc.regular.address.title",status:"upcoming",path:"/verification/address",data:void 0},document:{name:"kyc.regular.document.title",status:"upcoming",path:"/verification/document",data:void 0},selfie:{name:"kyc.regular.selfie.title",status:"upcoming",path:"/verification/selfie",data:void 0},checking:{name:"kyc.regular.checking.title",status:"upcoming",path:"/verification/checking"}}},status:"init",helpStatus:"",kycStatus:void 0,loading:"init",country:"",reasons:[],backendError:void 0}),actions:{async initKYCws(){const e=await Object(c.a)(),t=Object(r.useUserStore)();await e.connect(),await e.listen("kycStatusUpdate","verificationStore",(e=>{const{status:s,reason:i,timeUntilBlock:a}=e;this.status=s,t.timeUntilBlock=a,i&&this.reasons.push(i)}))},async initRestrictionWs(){const e=await Object(c.a)();await e.connect(),e.listen("kycRestrictionEvent","verificationStore",(e=>{const{kycStatus:t}=e;this.kycStatus=t}))},async getKycInfo(){try{const e=Object(r.useUserStore)(),{data:t}=await a.a.getStatusFlowKyc();this.clearData(),e.$patch((e=>{e.kycFlow=t.kycFlow})),this.status=t.status,t.reason&&this.reasons.push(t.reason)}catch(e){e instanceof n.a&&this.$nuxt.$notifier.error({title:"notify.failedToFetch",code:o.e.FailedToGetKycStatus,text:Object.values(e.data).join(". ")})}},async getKYCstatus(){const e=Object(r.useUserStore)();if("loading"!==this.loading){this.loading="loading";try{if(e.isOldKYC){const{data:t}=await a.a.getKycStatus(),{data:{kycFlow:s}}=await a.a.getStatusFlowKyc();if(e.$patch((e=>{e.kycFlow=s})),this.loading="ok",e.isOldKYC&&(this.country=t.country),t.customer.approved)return this.status="approved";const i=t.passport,n=t.documents,r=i.submitted||n.submitted,o=(i.disapproved||n.disapproved)&&"rejected"!==this.status;if(r&&!o)return this.status="submitted";if(o){this.clearData(),this.status="disapproved";const e=(null==i?void 0:i.reason)||"",t=(null==n?void 0:n.reason)||"";e&&t&&e!==t?this.reasons.push(e,t):e?this.reasons.push(e):t&&this.reasons.push(t)}}else this.loading="init",await Promise.all([this.getKycInfo(),this.initKYCws(),this.initRestrictionWs()]),this.loading="ok"}catch(e){e instanceof n.a&&this.$nuxt.$notifier.error({title:"notify.failedToFetch",code:o.e.FailedToGetKycStatus,text:Object.values(e.data).join(". ")}),this.loading="error"}}},async submitKYCdata(){var e;const t=new FormData,s=this.regular.steps.information.data,i=this.regular.steps.address.data,r=this.regular.steps.document.data,c=null===(e=this.regular.steps)||void 0===e||null===(e=e.selfie)||void 0===e?void 0:e.data;if(s)for(const[e,i]of Object.entries(s))t.append(e,i||"");if(i)for(const[e,s]of Object.entries(i))t.append(e,s||"");if(r){switch(r.type){case"passport":r.secondPage&&(t.append("isLocalPassport","1"),t.append("passportBack",r.secondPage)),t.append("passport",r.firstPage);break;case"international":t.append("passport",r.firstPage);break;case"idCard":t.append("idCardFront",r.firstPage),t.append("idCardBack",r.secondPage||"");break;case"driver":t.append("driverLicenseFront",r.firstPage),t.append("driverLicenseBack",r.secondPage||"")}r.expirationDate&&!r.withoutExpirationDate&&t.append("expirationDate",r.expirationDate)}if(c)for(const[e,s]of Object.entries(c))t.append(e,s||"");try{await a.a.postSubmitKyc(t),this.status="submitted",this.clearData()}catch(e){if(e instanceof n.a){this.$nuxt.$notifier.error({title:"notify.error",text:Object.values(e.data).join("."),code:o.e.FailedToSubmitKYC});for(const[t,s]of Object.entries(this.regular.steps)){if("checking"===t)break;for(const i of Object.keys(e.data)){if(s.data[i])return this.backendError=e.data,Promise.reject(t);if(s.data.type&&(i.includes(s.data.type)||"passport"===i))return this.backendError=e.data,Promise.reject(t)}}}}},clearData(){const e=Object(r.useUserStore)();this.reasons=[],e.isOldKYC||(this.country="");for(const e of Object.values(this.regular.steps))e.data=void 0,""!==this.helpStatus&&(e.status="upcoming")},setCountry(e){this.country=e},setHelpStatus(e){this.helpStatus=e},setStatus(e){this.status=e},setStepData(e,t){this.regular.steps[e].data=t,this.regular.steps[e].status="success"},changeStepStatus(e,t){for(const[e,t]of Object.entries(this.regular.steps))"active"===t.status&&(this.regular.steps[e].status="upcoming"),"active"===this.regular.steps.address.status&&(this.regular.steps.information.status="success"),"active"===this.regular.steps.document.status&&(this.regular.steps.address.status="success",this.regular.steps.information.status="success"),"upcoming"===this.regular.steps.document.status&&"active"===this.regular.steps.selfie.status&&window.$nuxt.context.redirect(window.$nuxt.localePath("/verification/regular/document"));this.regular.steps[e].status=t}},getters:{kycRestricted:e=>"required"===e.kycStatus||"submitted"===e.kycStatus,finallyDisapprove:e=>"rejected"===e.status},persist:{paths:["regular.steps.information.data","regular.steps.address.data","country"]}})}},[[0,332,344,334,345,336,342,347,337,343,338,339,340,335,341,346,153,150,151,152]]]);